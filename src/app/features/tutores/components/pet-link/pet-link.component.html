<mat-card class="pet-link">
  <mat-card-header>
    <mat-card-title>
      <mat-icon>pets</mat-icon>
      Pets Vinculados
    </mat-card-title>
  </mat-card-header>
  <mat-card-content>
    @if (!readOnly) {
      <div class="pet-link__add">
        <app-autocomplete
          #autocomplete
          [searchFn]="searchPets.bind(this)"
          [displayFn]="displayPet.bind(this)"
          [label]="'Buscar pet para vincular...'"
          [icon]="'search'"
          (optionSelected)="onPetSelected($event)"
          class="pet-link__autocomplete"
        ></app-autocomplete>
        <button
          mat-raised-button
          color="primary"
          (click)="onLinkPet()"
          type="button"
          class="pet-link__add-btn"
          matTooltip="Vincular pet selecionado ao tutor"
        >
          <mat-icon>link</mat-icon>
          Vincular
        </button>
      </div>
    }
    @if (linkedPets.length > 0) {
      <div class="pet-link__list">
        @for (pet of linkedPets; track pet.id) {
          <div class="pet-link__item">
            <div class="pet-link__item-info">
              <app-entity-photo
                [photoUrl]="pet.foto?.url"
                [alt]="pet.nome"
                [icon]="'pets'"
                [entityId]="pet.id"
              ></app-entity-photo>
              <div class="pet-link__item-details">
                <span class="pet-link__item-name">{{ pet.nome }}</span>
                <span class="pet-link__item-race">{{ pet.raca }}</span>
              </div>
            </div>
            @if (!readOnly) {
              <button
                mat-icon-button
                color="warn"
                (click)="onUnlinkPet(pet.id)"
                class="pet-link__item-remove"
                type="button"
                matTooltip="Desvincular pet"
              >
                <mat-icon>delete</mat-icon>
              </button>
            }
          </div>
        }
      </div>
    } @else {
      <div class="pet-link__empty">
        <mat-icon>pets</mat-icon>
        <p>Nenhum pet vinculado</p>
      </div>
    }
  </mat-card-content>
</mat-card>
